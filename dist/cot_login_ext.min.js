"use strict";CotSession.prototype.isLoggedIn=function(o){return function(s){var e=this;if("function"!=typeof s)return o();var r=this.sid||this._cookie("sid");if(null!=r){var t="".concat(this.options.ccApiOrigin).concat(this.options.ccApiPath).concat(this.options.ccApiEndpoint);t=-1!==t.indexOf("/c3api_auth/v2/AuthService.svc/AuthSet")?"".concat(t,"('").concat(r,"')"):"".concat(t,"/").concat(r),$.get(t).done(function(t){var o=t.app||"",n=t.sid||"",i=t.error||"";o===e.options.appName&&n===r?(e._storeLogin(t),s(CotSession.LOGIN_CHECK_RESULT_TRUE)):"no_such_session"===i?(e.logout(),s(CotSession.LOGIN_CHECK_RESULT_FALSE)):s(CotSession.LOGIN_CHECK_RESULT_INDETERMINATE)}).fail(function(){s(CotSession.LOGIN_CHECK_RESULT_INDETERMINATE)})}else s(CotSession.LOGIN_CHECK_RESULT_FALSE)}}(CotSession.prototype.isLoggedIn),CotSession.prototype.login=(CotSession.prototype.login,function(i){var o=this;i=$.extend({username:"",password:"",success:function(){},error:function(){},always:function(){}},i);var t={app:this.options.appName,user:i.username,pwd:i.password},n={method:"POST",url:"".concat(this.options.ccApiOrigin).concat(this.options.ccApiPath).concat(this.options.ccApiEndpoint)};-1!==n.url.indexOf("/c3api_auth/v2/AuthService.svc/AuthSet")?(n.contentType="application/json",n.data=JSON.stringify(t)):n.data=t,$.ajax(n).done(function(t){t.error?i.error(null,"invalid_user_or_pwd"===t.error?"Invalid username or password":"Login failed",t.error):t.passwordIsExpired?i.error(null,"Expired password","passwordIsExpired"):(o._storeLogin(t),i.success())}).fail(function(t,o,n){i.error(t,o,n)}).always(function(){i.always()})}),cot_login.prototype.checkLogin=function(){var t=this;return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).serverSide?new Promise(function(o,n){t.isLoggedIn(function(t){t===CotSession.LOGIN_CHECK_RESULT_INDETERMINATE?n():o(t===CotSession.LOGIN_CHECK_RESULT_TRUE)})}):Promise.resolve(this.isLoggedIn())},cot_login.prototype.isLoggedIn=function(t){return this.session.isLoggedIn(t)},cot_login.prototype.requireLogin=function(n){var i=this;return this.checkLogin(n).then(function(t){if(!1===t)return new Promise(function(t,o){i.showLogin($.extend({onHidden:function(){i.checkLogin(n).then(function(){t()},function(){i.logout(),o()})}},n))})})},cot_login.prototype.showLogin=function(t){var o=this;this.modal=cot_app.showModal($.extend({body:'\n\t\t\t<form>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label for="cot_login_username">Username</label>:\n\t\t\t\t\t<input class="form-control" id="cot_login_username">\n\t\t\t\t</div>\n\t\t\t\t<div class="form-group">\n\t\t\t\t\t<label for="cot_login_password">Password</label>:\n\t\t\t\t\t<input class="form-control" type="password" id="cot_login_password">\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t',className:"cot-login-modal",footerButtonsHtml:'\n\t\t\t<button class="btn btn-default btn-cot-login" type="button">Login</button>\n\t\t\t<button class="btn btn-default" type="button" data-dismiss="modal">Cancel</button>\n\t\t',originatingElement:$(this.options.welcomeSelector).find("a.login"),title:"User Login",onShown:function(){o.modal.find(".btn-cot-login").click(function(){o._login()}),o.modal.find(".modal-body input").keydown(function(t){13===(t.charCode||t.keyCode||0)&&o._login()})}},t))};
//# sourceMappingURL=cot_login_ext.min.js.map
